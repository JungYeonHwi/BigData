# 분석모형 설계

## SECTION 01. 분석 절차 수립

### 01. 분석 모형 선정

1) 분석 모형 선정 필요성

- 분석 기법 또는 분석 알고리즘을 적용하기 전에 분석 모형에 대한 선정 필요
- 분석이 필요한 데이터 속성을 세부적으로 파악, 처리한 뒤에 분석 모형을 선정, 적합한 분석 기법 선택
- 데이터가 준비되어 있지 않다면 사전 분석 목적을 정확하게 파악해야 문제 인식과 필요 데이터 준비에 따른 분석 모형 선정을 수월하게 진행 가능

2) 분석 모형 선정 프로세스

- 문제요건 정의 또는 비즈니스 이해에 따른 대상 데이터 선정과 분석 목표/조건 정의 
- 데이터 수집, 정리 및 도식화
- 데이터 전처리(데이터 정제, 종속/독립변수 선정, 데이터 변환, 데이터 통합, 데이터 축소 등)
- 최적의 분석 모형 선정

### 02. 분석 모형 정의

1) 분석 모형 정의와 종류

- 분석 모형은 분석 목표에 따라 데이터 특성을 도출하고, 가설 수립에 따라 전체적인 분석 방향을 정의하는 모형으로 예측 분석 모형, 현황 진단 모형, 최적화 분석 모형 등으로 구분
- 예측 분석 모형 : 과거, 현재까지의 데이터와 상황에 따른 가설을 기반하여 미래에 대한 현상을 사전에 분류하고 예측하는 모형
- 현황 진단 모형 : 과거 데이터를 통해 현재 상황을 객관적으로 진단하는 모형으로 미래 예측이 아닌 현재를 이해함에 활용
- 최적화 분석 모형 : 제한된 자원, 환경 내에서 최대의 효용성, 이익과 같은 결과를 생성하기 위해 분석 모델을 최적화하는 데에 중점

2) 분석 모형 정의를 위한 사전 고려사항

- 분석 모형을 정의하기 전에 분석이 실제 추진될 수 있을지 가능성을 타진하는 것이 중요
- 분석을 진행하기 이전 상황에 맞는 평가 기준표, 테이블을 작성하여 항목별로 점수를 부여하고 총점을 매긴 후 분석 모형 정의의 가능성을 판별 가능
- 추집시급성과 구현가능성만으로 부석 모형 정의를 위한 사전 판별 기준 활용 가능
- 분석 모형 정의에 필요한 데이터가 충분히 확보되어 있는지를 판단하여 관련 과거 분석 사례 또는 솔루션을 최대한 활용할 수 있는지 검통한다면 보다 효율적인 분석 모형 설계 진행 가능
- 상향식 접근
    - 문제 정의가 어려울 경우 많은 양의 데이터 분석을 통해 인사이트 도출
    - 특정 영역을 지정하여 의사결정을 지점으로 진행하는 과정에서 분석 과제를 발굴하는 방식
- 하향식 접근
    - 문제 정의가 가능할 시 문제 탐색과 연관되어 비즈니스 모델, 외부 참조 모델, 분석 유스 케이스 기반 모델로 발굴하는 방식 적용 가능
    - 비즈니스 모델은 어떻게 수익을 창출할 것인가에 대한 검증으로 문제해결 위한 분석 과제를 발굴하며 외부 참조 모델은 벤치마킹으로 분석 테마 후보 Pool을 구축, 선택하는 것
    - 분석 유스케이스는 문제에 대한 상세 설명과 해결 시 효과에 대해 명시함으로써 구체적인 분석 과제들을 도출

### 03. 분석 모형 구축 절차

1) 분석 시나리오 작성

- 분석 시나리오 작성을 통해 분석 과정과 결과가 어떻게 활용되는지 명확하게 이해할 수 있음
- 데이터 분석 대상 및 범위를 요구사항에 맞게 정의하며 분석을 통해 해결할 수 있는 문제와 목표 그리고 분석 목표별 구현 모델과 예상 결과 작성
- 분석 과정에 필요한 데이터, 절차, 분석기법 등의 세부사항들을 정의, 데이터의 경우 사전 확보 및 유형 분석이 필요하며 기존에 잘 구현되어 활용되고 있는 유사 분석 시나리오 및 솔루션을 고려 가능

2) 분석 모형 설계 : 분석 대상 및 범위를 정하여 분석 목적을 구현하기 위한 분석 방법론을 설계하는 단계

- 분석 모형 설계 시 사전 확인 사항
    - 필요한 데이터 항목이 정해졌는가?
    - 데이터 단위를 고려, 항목에 따른 표준화 방법을 정하였는가?
    - 데이터를 수집한 항목에 따라, 단계별로 모델이 설계되었는가?
    - 분석 검증 통계 기법을 선정하였는가?
- 분석 모델링 설계와 검정
    - 분석 목적에 기반한 가설검정 방법을 수립
    - 추정방법에 대한 기술 검토
    - 분석 모델링 설계와 검정 방법 수립
- 분석 모델링에 적합한 알고리즘 설계
    - 비지도학습 : 군집분석, 연관성분석, 오토인코더 등
    - 지도학습 : 의사결정트리, 랜덤 포레스트, 서프토벡터머신, 회귀분석 등
    - 준지도학습 : 셀프 트레이닝, 적대적 생성 모델 등
    - 강화학습 : Q-Learning, 정책경사 등
- 분석 모형 개발 및 테스트
    - 모듈 기능 정의
    - 모듈 설계
    - 모듈 개발 결과물과 모델 설계 일치 확인
    - 모듈의 정상 동작 여부 검증

3) 분석 모델링 설계과 검정 - 분석 목적에 기반한 가설검정 방법

- 유의수준 결정, 귀무가설과 대립가설 설정
    - 귀무가설은 직접 검정 대상이 되는 가설
    - 가설검정을 시행할 때는 귀무가설이 옳다는 가정하에 시작
    - 대립가설은 귀무가설이 기각이 될 때 받아들여지는 가설로 정의
- 검정통계량의 설정
    - 검정통계량은 가설을 검정하기 위한 기준으로 사용하는 값 의미
    - 검정통계량이 확률분포 상에 어디에 위치하는지에 따라 귀무가설을 기각하거나 기각하지 않음
- 기각역의 설정
    - 기각역은 확률분포에서 귀무가설을 기각하는 영역
    - 기각역에 검정통계량이 위치하면 귀무가설 기각
- 검정통계량 계산
    - 계산식 : (표본평균 - 모평균) / (표본 표준편차)
    - 신뢰수준 : 가설을 검정할 때 어느 정도로 검정할 것인지에 대한 수준
    - 유의수준 : 가설을 검정할 때 일정 수준을 벗어나면 귀무가설이 오류라고 판단하는 수준
        - 유의수준의 수학적 의미는 기각역들의 합, 1에서 신뢰수준을 뺀 값
- 통계적인 의사결정(가설검정)
    - 양측검정 : 귀무가설을 기각하는 영역이 양쪽에 있는 검정
    - 단측검정 : 양측검정과는 달리 귀무가설을 기각하는 영역이 한쪽 끝에 있는 검정
    - 통계적인 의사결정 단계에서는 계산한 검정 통계량을 t값 분포도와 비교하여 기각역에 속하는지 아닌지를 판단

4) 분석 모델링 설계와 검정 - 추정 방법에 대한 기술 검토

- 전체적으로 데이터에 대한 전처리 과정을 마치게 되면 모형에 활용될 후보 변수와 후보 분석 모형에 사용할 알고리즘 파악
- 기초 통계, 데이터 검증, 데이터 정제 등의 데이터 변환 과정을 거치면 후보 변수는 전처리 과정에서 선정
- 분석 모형은 크게 분류예측 추천 등의 예측 분석, 과거 데이터를 기반하여 현재를 진단하는 현황 진단, 시뮬레이션과 제한된 환경 최적화를 모색하는 예측 최적화로 나뉨
    - 분석 모형을 선정하는 문제는 비즈니스 환경 여건이나 종속 변수의 유무에 따라 달라지기 때문에 종속 변수가 있는지 없는지를 살펴보아야 함
    - 종속 변수의 유무에 따라 사용할 알고리즘이 제한을 받음

## SECTION 02. 분석 환경 구축

### 01. 분석 도구 선정

1) R

- 객체지향 언어 : 일반 데이터, 함수, 차트 등 모든 데이터가 객체 형태로 관리되어 효율적인 조작과 저장방법 제공
- 고속메모리 처리 : 모든 객체는 메모리로 로딩되어 고속으로 처리되고 재사용 가능
- 다양한 자료 구조 : 벡터, 배열, 행렬, 데이터프레임, 리스트 등 다양한 자료구조와 연산기능 제공
- 최신 패키지 제공 : 오픈소스 커뮤니티 CRAN 사이트를 통해 데이터 분석에 필요한 최신의 알고리즘과 방법론을 제공
- 시각화 : 데이터 분석과 표현을 위한 다양한 그래픽 도구 제공
- R Studio는 R을 위한 오픈소스 통합개발환경으로 편리한 분석 개발 인터페이스를 제공

2) 파이썬

- 배우기 쉬운 대화 기능의 인터프리티 언어 : 간결하고 쉬운 문법으로 컴파일, 실행, 테스트 용이
- 동적인 데이터타입 결정 지원 : 동적으로 데이터타입을 결정하므로 데이터타입에 무관하게 코드 작성 가능
- 플랫폼 독립적 언어 : 운영체제에 독립적으로 컴파일 없이 동작 실행
- 내장 객체 자료형과 자동 메모리 관리 : 리스트, 사전, 튜플 등 유연한 내장 객체 자료형을 지원하며 메모리 자동할당 뒤 종료 시 자동 해지하는 메모리 청소 기능 제공
- 파이썬 아나콘다는 파이썬 기반의 데이터 분석에 필요한 오픈소스들의 통합 개발 플랫폼으로 가상환경과 패키지를 관리, 개별 프로젝트 개발 환경을 효율적으로 구성 가능

### 02. 데이터 분할

1) 데이터 분할 정의 : 분석용 데이터로 모형을 구축하여 평가 및 검증하기 위해서 전체 데이터를 학습 데이터, 평가 데이터, 검증용 테스트 데이터로 분할

- 학습 데이터 : 데이터를 학습하여 분석 모형을 만드는 데에 직접 사용되는 데이터
- 평가 데이터 : 추정된 분석 모델이 과대/과소적합인지 모형의 성능을 평가하기 위한 데이터
- 검증용 테스트 데이터 : 최종적으로 일반화된 분석 모형을 검증하는 테스트를 위한 데이터
- 보통 학습과 검증을 위해서는 7:3 또는 8:2 비율로 진행되며 전체적인 훈련, 평가, 검증용 테스트 데이터 비율은 일반적으로 4:3:3 또는 5:3:2로 정함

2) 과대적합과 과소적합

- 과대적합(과적합)
    - 일반적으로 학습 데이터는 실제 데이터의 부분 집합이므로 학습 데이터에 최적화된 분석 모델이 만들어지게 되면 실제 데이터에서 오차가 발생할 확률이 큼
    - 학습(훈련) 데이터에 대해서는 높은 정확도를 나타내지만 테스트 데이터나 새로운 데이터에 대해서는 예측을 잘 하지 못하는 것을 과대적합이라고 함
    - 과대적합 방지를 위한 것으로 데이터 분할 외에 K-fold 교차검증, 정규화 등의 방법 존재
- 과소적합 : 모형이 단순하여 데이터 내부의 패턴 또는 규칙을 잘 학습하지 못하는 것, 학습 데이터에서도 정확한 결과를 도출하지 못함
- 일반화 : 학습 데이터를 통해 생성된 모델이 평가 데이터를 통한 성능 평가 외에도 검증용 테스트 데이터를 통해 정확하게 예측하는 모델